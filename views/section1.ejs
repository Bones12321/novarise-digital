<%- include('partials/header', { title: 'Guide to Freedom' }) %>

<style>
  body {
    font-family: 'Outfit', sans-serif;
    margin: 0;
    padding: 0;
    background: url('/images/hero-bg.jpg') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
  }

  h1 {
    text-align: center;
    margin: 60px 0 20px;
    font-size: 2.8rem;
    font-weight: 700;
    text-shadow: 0 2px 6px rgba(0,0,0,0.5);
  }

  .description {
    text-align: center;
    max-width: 750px;
    margin: 0 auto 40px;
    font-size: 1.1rem;
    font-weight: 500;
    color: #fff;
    text-shadow: 0 1px 4px rgba(0,0,0,0.6);
  }

  .products-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .product-box {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px) saturate(180%);
    -webkit-backdrop-filter: blur(10px) saturate(180%);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    text-align: center;
    color: #111;
    cursor: pointer;
  }
  .product-box:hover {
    transform: scale(1.05);
    box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.25);
  }

  .product-box img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: 8px;
    margin-bottom: 15px;
  }

  .product-box h2 {
    font-size: 1.2rem;
    margin-bottom: 10px;
    color: #111;
  }

  .product-box p {
    font-size: 1rem;
    margin-bottom: 15px;
    color: #333;
  }

  .product-box button {
    padding: 10px 20px;
    font-size: 1rem;
    border: none;
    border-radius: 25px;
    background-color: #222;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .product-box button:hover {
    background-color: #444;
  }

  .quote {
    text-align: center;
    margin: 60px auto 40px;
    font-size: 1.5rem;
    font-style: italic;
    font-weight: bold;
    color: #fff;
    text-shadow: 0 2px 5px rgba(0,0,0,0.7);
  }

  /* === MOBILE-ONLY CHANGES === */
  @media (max-width: 768px) {
    /* Glassy box for description */
    .description {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px) saturate(180%);
      -webkit-backdrop-filter: blur(10px) saturate(180%);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
      color: #111;
      padding: 25px 20px;
      text-shadow: none;
      font-weight: 500;
      font-size: 1.1rem;
      max-width: 90%;
      margin-bottom: 40px;
    }

    /* Smaller products and two per row */
    .products-container {
      grid-template-columns: repeat(2, 1fr);
      max-width: 100%;
      padding: 10px;
    }

    .product-box img {
      height: 140px;
    }

    .product-box h2 {
      font-size: 1rem;
    }

    .product-box p {
      font-size: 0.9rem;
    }
  }
</style>

<main>
  <h1>Guide to Freedom</h1>

  <p class="description">
    At NovaRise, we believe digital products are the future of personal growth. Our guides, blueprints, and tools are designed to help you build discipline, mental resilience, and financial freedom — all accessible instantly from anywhere in the world. By selling digital products, we remove barriers and empower you to take action at your own pace. Every product we offer is crafted with purpose, clarity, and real-life application. Our mission is to help you unlock your full potential, one digital guide at a time.
  </p>

  <div class="products-container">
    <% products.forEach((product, index) => { %>
      <div class="product-box">
        <img src="<%= product.image %>" alt="<%= product.title %>" />
        <h2><%= product.title %></h2>
        <p>$<%= product.price.toFixed(2) %></p>
        <button class="add-to-cart-btn" 
                data-id="<%= index %>" 
                data-name="<%= product.title %>" 
                data-price="<%= product.price %>">
          Add to Basket
        </button>
      </div>
    <% }); %>
  </div>

  <p class="quote">
    "Discipline is the bridge between goals and freedom." – NovaRise
  </p>
</main>

<%- include('partials/footer') %>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // Handle Add to Basket clicks with AJAX
  document.querySelectorAll('.add-to-cart-btn').forEach(button => {
    button.addEventListener('click', async () => {
      const id = button.dataset.id;
      const name = button.dataset.name;
      const price = button.dataset.price;

      try {
        const response = await fetch('/cart/add', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id, name, price })
        });

        if (response.ok) {
          const data = await response.json();
          alert(`Added "${name}" to basket!`);

          // Update cart badge in navbar
          const badge = document.querySelector('nav .badge');
          if (badge) {
            if (data.cartCount > 0) {
              badge.textContent = data.cartCount;
              badge.style.display = 'inline-block';
            } else {
              badge.style.display = 'none';
            }
          }
        } else {
          alert('Failed to add to basket. Please try again.');
        }
      } catch (error) {
        console.error('Error adding to cart:', error);
        alert('An error occurred. Please try again later.');
      }
    });
  });
</script>
